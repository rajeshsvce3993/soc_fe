"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[184],{4184:function(e,s,t){t.r(s),t.d(s,{default:function(){return s8}});var a=t(5893),r=t(4271),i=t(8590),n=t(3454);async function l(e){if(!e.ok){let s=await e.text()||e.statusText;throw Error("".concat(e.status,": ").concat(s))}}let d=new i.S({defaultOptions:{queries:{queryFn:(e=>{let{on401:s}=e;return async e=>{let{queryKey:t}=e,a=n.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:4000",r=localStorage.getItem("soc_token"),i=t.join("/"),d=i.startsWith("/api")?"".concat(a).concat(i):i,o=await fetch(d,{credentials:"include",headers:r?{Authorization:"Bearer ".concat(r)}:void 0});return"returnNull"===s&&401===o.status?null:(await l(o),await o.json())}})({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!0,refetchOnMount:!0,staleTime:0,retry:!1},mutations:{retry:!1}}});var o=t(202),c=t(7294);let x=0,m=new Map,u=e=>{if(m.has(e))return;let s=setTimeout(()=>{m.delete(e),b({type:"REMOVE_TOAST",toastId:e})},1e6);m.set(e,s)},h=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?u(t):e.toasts.forEach(e=>{u(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},p=[],f={toasts:[]};function b(e){f=h(f,e),p.forEach(e=>{e(f)})}function g(e){let{...s}=e,t=(x=(x+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>b({type:"DISMISS_TOAST",toastId:t});return b({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>b({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function j(){let[e,s]=c.useState(f);return c.useEffect(()=>(p.push(s),()=>{let e=p.indexOf(s);e>-1&&p.splice(e,1)}),[e]),{...e,toast:g,dismiss:e=>b({type:"DISMISS_TOAST",toastId:e})}}var N=t(7626),v=t(2003),y=t(2190),w=t(512),z=t(8388);function k(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,z.m6)((0,w.W)(s))}let C=N.zt,A=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(N.l_,{ref:s,className:k("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...r})});A.displayName=N.l_.displayName;let S=(0,v.j)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),T=c.forwardRef((e,s)=>{let{className:t,variant:r,...i}=e;return(0,a.jsx)(N.fC,{ref:s,className:k(S({variant:r}),t),...i})});T.displayName=N.fC.displayName,c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(N.aU,{ref:s,className:k("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...r})}).displayName=N.aU.displayName;let R=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(N.x8,{ref:s,className:k("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...r,children:(0,a.jsx)(y.Z,{className:"h-4 w-4"})})});R.displayName=N.x8.displayName;let _=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(N.Dx,{ref:s,className:k("text-sm font-semibold",t),...r})});_.displayName=N.Dx.displayName;let P=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(N.dk,{ref:s,className:k("text-sm opacity-90",t),...r})});function E(){let{toasts:e}=j();return(0,a.jsxs)(C,{children:[e.map(function(e){let{id:s,title:t,description:r,action:i,...n}=e;return(0,a.jsxs)(T,{...n,children:[(0,a.jsxs)("div",{className:"grid gap-1",children:[t&&(0,a.jsx)(_,{children:t}),r&&(0,a.jsx)(P,{children:r})]}),i,(0,a.jsx)(R,{})]},s)}),(0,a.jsx)(A,{})]})}P.displayName=N.dk.displayName;var O=t(6908);let F=O.zt;O.fC,O.xz,c.forwardRef((e,s)=>{let{className:t,sideOffset:r=4,...i}=e;return(0,a.jsx)(O.VY,{ref:s,sideOffset:r,className:k("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...i})}).displayName=O.VY.displayName;var I=t(8979),Z=t(2542),M=t(8267),D=t(3633),U=t(5264),V=t(6428),L=t(775),q=t(8497),K=t(8426);let B=(0,v.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground border border-destructive-border",outline:" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Y=c.forwardRef((e,s)=>{let{className:t,variant:r,size:i,asChild:n=!1,...l}=e,d=n?K.g7:"button";return(0,a.jsx)(d,{className:k(B({variant:r,size:i,className:t})),ref:s,...l})});Y.displayName="Button";var G=t(2854);let W=G.fC,H=G.xz;G.x8;let J=G.h_,$=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(G.aV,{className:k("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:s})});$.displayName=G.aV.displayName;let Q=(0,v.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),X=c.forwardRef((e,s)=>{let{side:t="right",className:r,children:i,...n}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)($,{}),(0,a.jsxs)(G.VY,{ref:s,className:k(Q({side:t}),r),...n,children:[i,(0,a.jsxs)(G.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(y.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});X.displayName=G.VY.displayName,c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(G.Dx,{ref:s,className:k("text-lg font-semibold text-foreground",t),...r})}).displayName=G.Dx.displayName,c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(G.dk,{ref:s,className:k("text-sm text-muted-foreground",t),...r})}).displayName=G.dk.displayName;let ee=t(3454).env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:4000";function es(){let e=localStorage.getItem("soc_token"),s={"Content-Type":"application/json",Accept:"application/json"};return e&&(s.Authorization="Bearer ".concat(e)),s}let et={login:async(e,s)=>{let t=await fetch("".concat(ee,"/api/auth/signin"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:e,password:s})});if(!t.ok)throw Error(await t.text().catch(()=>"")||"Auth failed (".concat(t.status,")"));return await t.json()},sendOtp:async e=>{let s=await fetch("".concat(ee,"/api/auth/send-otp"),{method:"POST",headers:es(),body:JSON.stringify({email:e})});if(!s.ok)throw Error(await s.text().catch(()=>"")||"Send OTP failed (".concat(s.status,")"));return await s.json()},verifyOtp:async(e,s)=>{let t=await fetch("".concat(ee,"/api/auth/verify-otp"),{method:"POST",headers:es(),body:JSON.stringify({email:e,otp:s})});if(!t.ok)throw Error(await t.text().catch(()=>"")||"Verify OTP failed (".concat(t.status,")"));return await t.json()},updatePassword:async(e,s)=>{let t=await fetch("".concat(ee,"/api/auth/update-password"),{method:"POST",headers:es(),body:JSON.stringify({email:e,newPassword:s})});if(!t.ok)throw Error(await t.text().catch(()=>"")||"Update password failed (".concat(t.status,")"));return await t.json()}},ea=async()=>{let e=await fetch("".concat(ee,"/api/users"),{headers:es()});if(!e.ok)throw Error("Failed to fetch users (".concat(e.status,")"));let s=await e.json();return s&&"object"==typeof s&&Array.isArray(s.data)?s.data:Array.isArray(s)?s:[]},er=async e=>{let s=await fetch("".concat(ee,"/api/auth/signup"),{method:"POST",headers:es(),body:JSON.stringify(e)});if(!s.ok)throw Error(await s.text().catch(()=>"")||"Create user failed (".concat(s.status,")"));return await s.json()},ei=async()=>{let e=await fetch("".concat(ee,"/api/users/only-users"),{headers:es()});if(!e.ok)throw Error(await e.text().catch(()=>"")||"Failed to fetch assignable users (".concat(e.status,")"));let s=await e.json();return s&&"object"==typeof s&&Array.isArray(s.data)?s.data:Array.isArray(s)?s:[]},en=async()=>(await new Promise(e=>setTimeout(e,120)),[{value:"user",label:"User"},{value:"admin",label:"Administrator"}]),el=async()=>{try{let e=await fetch("".concat(ee,"/api/dashboard/getmetrics"),{headers:es()});if(!e.ok)throw Error("Failed to fetch metrics (".concat(e.status,")"));let s=await e.json();if(s&&s.data)return s.data;return{}}catch(e){return await new Promise(e=>setTimeout(e,500)),{totalCases:0,totalCasesTrend:"0",openCases:0,closedCases:0,mttd:0,mttr:0}}},ed=async e=>{var s,t;let a=null!==(s=null==e?void 0:e.points)&&void 0!==s?s:10,r=null!==(t=null==e?void 0:e.days)&&void 0!==t?t:30;try{let e=await fetch("".concat(ee,"/api/dashboard/gettrends?points=").concat(a,"&days=").concat(r),{headers:es()});if(!e.ok)throw Error("Failed to fetch trends (".concat(e.status,")"));let s=await e.json();if(s&&s.data&&Array.isArray(s.data.series))return s.data.series;if(Array.isArray(s))return s}catch(e){}},eo=async()=>{try{let e=await fetch("".concat(ee,"/api/dashboard/detection-accuracy"),{headers:es()});if(!e.ok)throw Error("Failed to fetch accuracy metrics (".concat(e.status,")"));let s=await e.json();if(s&&s.data)return s.data}catch(e){}},ec=async()=>{let e=await fetch("".concat(ee,"/api/dashboard/recent-activities"),{headers:es()});if(!e.ok)throw Error(await e.text().catch(()=>"")||"Failed to fetch recent activities (".concat(e.status,")"));let s=await e.json();return s&&Array.isArray(s.data)?s.data:Array.isArray(s)?s:[]},ex=async e=>{var s,t;let a=null!==(s=null==e?void 0:e.limit)&&void 0!==s?s:10,r=null!==(t=null==e?void 0:e.skip)&&void 0!==t?t:0,i=await fetch("".concat(ee,"/api/alerts?limit=").concat(a,"&skip=").concat(r),{headers:es()});if(!i.ok)throw Error(await i.text().catch(()=>"")||"Failed to fetch alerts (".concat(i.status,")"));let n=await i.json();if(n&&"object"==typeof n){let e=Array.isArray(n.data)?n.data:Array.isArray(n)?n:[];return{items:e,total:"number"==typeof n.total?n.total:e.length,limit:"number"==typeof n.limit?n.limit:a,skip:"number"==typeof n.skip?n.skip:r}}return Array.isArray(n)?{items:n,total:n.length,limit:a,skip:r}:{items:[],total:0,limit:a,skip:r}},em=async(e,s)=>{let t=await fetch("".concat(ee,"/api/alerts/").concat(e),{method:"PATCH",headers:es(),body:JSON.stringify(s)});if(!t.ok)throw Error(await t.text().catch(()=>"")||"Failed to update alert (".concat(t.status,")"));return await t.json()},eu=async e=>{let s=await fetch("".concat(ee,"/api/investigations/").concat(e,"/timeline"),{headers:es()});if(!s.ok)throw Error(await s.text().catch(()=>"")||"Failed to fetch investigation timeline (".concat(s.status,")"));let t=await s.json();return t&&"object"==typeof t&&Array.isArray(t.data)?t.data:Array.isArray(t)?t:[]},eh=(0,c.createContext)(void 0);function ep(e){let{children:s}=e,[t,r]=(0,c.useState)(null),[i,n]=(0,c.useState)(!1),[l,o]=(0,c.useState)(!0);(0,c.useEffect)(()=>{let e=localStorage.getItem("soc_token"),s=localStorage.getItem("soc_user");if(e&&(n(!0),s))try{let e=JSON.parse(s);r(e)}catch(e){r(null)}o(!1)},[]);let x=async(e,s)=>{try{let t=await et.login(e,s);if(t&&t.token){localStorage.setItem("soc_token",t.token);let s={id:"number"==typeof t.id?t.id:t.id?Number(t.id):void 0,name:t.name||t.fullName||null,email:t.email||e,role:t.role||null};return localStorage.setItem("soc_user",JSON.stringify(s)),r(s),n(!0),!0}return!1}catch(e){return!1}};return(0,a.jsx)(eh.Provider,{value:{user:t,isAuthenticated:i,isLoading:l,login:x,logout:()=>{n(!1),r(null),localStorage.removeItem("soc_token"),localStorage.removeItem("soc_user"),d.clear()}},children:s})}function ef(){let e=(0,c.useContext)(eh);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}let eb=[{icon:I.Z,label:"Dashboard",href:"/"},{icon:Z.Z,label:"Alerts",href:"/alerts"},{icon:M.Z,label:"Users",href:"/users",adminOnly:!0},{icon:D.Z,label:"Reports",href:"/reports"},{icon:U.Z,label:"Settings",href:"/settings"}];function eg(){let[e]=(0,r.TH)(),[s,t]=(0,c.useState)(!1),{logout:i,user:n}=ef(),l=(null==n?void 0:n.role)==="admin"||(null==n?void 0:n.name)==="Admin",d=()=>(0,a.jsxs)("div",{className:"flex flex-col h-full bg-card border-r border-border",children:[(0,a.jsxs)("div",{className:"p-6 flex items-center gap-3 border-b border-border/50",children:[(0,a.jsx)("div",{className:"bg-primary/10 p-2 rounded-lg",children:(0,a.jsx)(V.Z,{className:"w-6 h-6 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"font-bold text-lg tracking-tight",children:"AuriSIEM"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground font-mono",children:"SOC Platform v2.0"})]})]}),(0,a.jsx)("nav",{className:"flex-1 p-4 space-y-2",children:eb.filter(e=>"Settings"!==e.label&&"Reports"!==e.label&&(!e.adminOnly||!!l)).map(s=>{let i=e===s.href;return(0,a.jsx)(r.rU,{href:s.href,children:(0,a.jsxs)("div",{className:k("flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 cursor-pointer group",i?"bg-primary text-primary-foreground shadow-lg shadow-primary/20 font-medium":"text-muted-foreground hover:bg-secondary/50 hover:text-foreground"),onClick:()=>t(!1),children:[(0,a.jsx)(s.icon,{className:k("w-5 h-5",i?"animate-pulse":"group-hover:scale-110 transition-transform")}),(0,a.jsx)("span",{children:s.label})]})},s.href)})}),(0,a.jsx)("div",{className:"p-4 space-y-2 border-t border-border/50",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 cursor-pointer group text-muted-foreground hover:bg-destructive/10 hover:text-destructive",onClick:()=>i(),children:[(0,a.jsx)(L.Z,{className:"w-5 h-5 group-hover:scale-110 transition-transform"}),(0,a.jsx)("span",{children:"Logout"})]})})]});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("aside",{className:"hidden lg:block w-72 h-screen sticky top-0",children:(0,a.jsx)(d,{})}),(0,a.jsx)("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:(0,a.jsxs)(W,{open:s,onOpenChange:t,children:[(0,a.jsx)(H,{asChild:!0,children:(0,a.jsx)(Y,{variant:"outline",size:"icon",className:"bg-card border-border",children:(0,a.jsx)(q.Z,{className:"w-5 h-5"})})}),(0,a.jsx)(X,{side:"left",className:"p-0 w-72 border-r border-border bg-card",children:(0,a.jsx)(d,{})})]})})]})}var ej=t(777);let eN=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:k("shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",t),...r})});eN.displayName="Card",c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:k("flex flex-col space-y-1.5 p-6",t),...r})}).displayName="CardHeader",c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:k("text-2xl font-semibold leading-none tracking-tight",t),...r})}).displayName="CardTitle",c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:k("text-sm text-muted-foreground",t),...r})}).displayName="CardDescription";let ev=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:k("p-6 pt-0",t),...r})});ev.displayName="CardContent",c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:k("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter";var ey=t(6127),ew=t(9354),ez=t(437),ek=t(3645),eC=t(39),eA=t(4715),eS=t(4549),eT=t(7017),eR=t(5615),e_=t(8793),eP=t(4570),eE=t(5400),eO=t(7483);let eF=c.forwardRef((e,s)=>{let{className:t,value:r,...i}=e;return(0,a.jsx)(eO.fC,{ref:s,className:k("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...i,children:(0,a.jsx)(eO.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});eF.displayName=eO.fC.displayName;let eI=c.forwardRef((e,s)=>{let{className:t,type:r,...i}=e;return(0,a.jsx)("input",{type:r,className:k("flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...i})});eI.displayName="Input";var eZ=t(952);let eM=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eZ.fC,{ref:s,className:k("\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r})});eM.displayName=eZ.fC.displayName,c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eZ.Ee,{ref:s,className:k("aspect-square h-full w-full",t),...r})}).displayName=eZ.Ee.displayName;let eD=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eZ.NY,{ref:s,className:k("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r})});eD.displayName=eZ.NY.displayName;var eU=t(3133),eV=t(4307),eL=t(8865),eq=t(162);let eK=eU.fC,eB=eU.xz;eU.ZA,eU.Uv,eU.Tr,eU.Ee,c.forwardRef((e,s)=>{let{className:t,inset:r,children:i,...n}=e;return(0,a.jsxs)(eU.fF,{ref:s,className:k("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",t),...n,children:[i,(0,a.jsx)(eV.Z,{className:"ml-auto"})]})}).displayName=eU.fF.displayName,c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eU.tu,{ref:s,className:k("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...r})}).displayName=eU.tu.displayName;let eY=c.forwardRef((e,s)=>{let{className:t,sideOffset:r=4,...i}=e;return(0,a.jsx)(eU.Uv,{children:(0,a.jsx)(eU.VY,{ref:s,sideOffset:r,className:k("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...i})})});eY.displayName=eU.VY.displayName;let eG=c.forwardRef((e,s)=>{let{className:t,inset:r,...i}=e;return(0,a.jsx)(eU.ck,{ref:s,className:k("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",t),...i})});eG.displayName=eU.ck.displayName,c.forwardRef((e,s)=>{let{className:t,children:r,checked:i,...n}=e;return(0,a.jsxs)(eU.oC,{ref:s,className:k("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:i,...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(eU.wU,{children:(0,a.jsx)(eL.Z,{className:"h-4 w-4"})})}),r]})}).displayName=eU.oC.displayName,c.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsxs)(eU.Rk,{ref:s,className:k("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(eU.wU,{children:(0,a.jsx)(eq.Z,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=eU.Rk.displayName;let eW=c.forwardRef((e,s)=>{let{className:t,inset:r,...i}=e;return(0,a.jsx)(eU.__,{ref:s,className:k("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",t),...i})});eW.displayName=eU.__.displayName;let eH=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eU.Z0,{ref:s,className:k("-mx-1 my-1 h-px bg-muted",t),...r})});function eJ(){var e,s,t,r,i;let{logout:n,user:l}=ef(),{data:d,isLoading:o}=(0,ej.a)({queryKey:["dashboard-metrics"],queryFn:el}),{data:c,isLoading:x}=(0,ej.a)({queryKey:["dashboard-trends"],queryFn:()=>ed()});function m(e,s){if(!e||e.length<2)return"-";let t=Number(e[0][s]),a=Number(e[e.length-1][s]);if(!isFinite(t)||0===t)return"-";let r=Math.round((a-t)/Math.abs(t)*100);return"".concat(r>0?"+":"").concat(r,"%")}let{data:u,isLoading:h}=(0,ej.a)({queryKey:["dashboard-accuracy"],queryFn:eo}),{data:p,isLoading:f,isError:b}=(0,ej.a)({queryKey:["dashboard-recent-activities"],queryFn:ec});return(0,a.jsxs)("div",{className:"p-8 space-y-8 bg-[#0a0f1e] min-h-screen text-zinc-100 font-sans",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{className:"relative w-96",children:[(0,a.jsx)(ey.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500"}),(0,a.jsx)(eI,{className:"bg-[#161e31] border-zinc-800 pl-10 h-10 rounded-lg text-sm focus:ring-cyan-500/20",placeholder:"Search alerts, IOCs, threat intel..."})]}),(0,a.jsx)("div",{className:"flex items-center gap-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 pl-4 border-l border-zinc-800",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-white",children:null!==(e=null==l?void 0:l.name)&&void 0!==e?e:"Guest"}),(0,a.jsx)("p",{className:"text-[10px] text-zinc-500",children:null!==(s=null==l?void 0:l.email)&&void 0!==s?s:""})]}),(0,a.jsxs)(eK,{children:[(0,a.jsx)(eB,{asChild:!0,children:(0,a.jsx)(eM,{className:"h-10 w-10 border-2 border-cyan-500/20 cursor-pointer hover:border-cyan-500 transition-colors",children:(0,a.jsx)(eD,{className:"bg-cyan-600 text-white font-bold",children:((null==l?void 0:l.name)||"G").split(" ").map(e=>e[0]).slice(0,2).join("")})})}),(0,a.jsxs)(eY,{align:"end",className:"w-64 bg-[#161e31] border-zinc-800 text-zinc-100",children:[(0,a.jsx)(eW,{children:"My Profile"}),(0,a.jsx)(eH,{className:"bg-zinc-800"}),(0,a.jsxs)(eG,{className:"cursor-pointer hover:bg-zinc-800 focus:bg-zinc-800",children:[(0,a.jsx)(M.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Profile Details"})]}),(0,a.jsxs)(eG,{className:"cursor-pointer text-rose-500 focus:text-rose-500 hover:bg-rose-500/10 focus:bg-rose-500/10",onClick:()=>n(),children:[(0,a.jsx)(L.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Log out"})]})]})]})]})})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-white",children:"Security Operations Dashboard"}),(0,a.jsx)("p",{className:"text-sm text-zinc-500",children:"Real-time threat monitoring and analytics"})]}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-4",children:o?Array.from({length:5}).map((e,s)=>(0,a.jsx)(eN,{className:"bg-[#161e31] border-zinc-800 shadow-xl",children:(0,a.jsxs)(ev,{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"p-2 bg-zinc-800 rounded-lg w-9 h-9 animate-pulse"}),(0,a.jsx)("div",{className:"h-4 w-10 bg-zinc-800 rounded animate-pulse"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"h-8 w-20 bg-zinc-800 rounded animate-pulse"}),(0,a.jsx)("div",{className:"h-3 w-24 bg-zinc-800 rounded animate-pulse"})]})]})},s)):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eN,{className:"bg-[#161e31] border-zinc-800 shadow-xl group",children:(0,a.jsxs)(ev,{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:(0,a.jsx)(ew.Z,{className:"w-5 h-5 text-blue-400"})}),(0,a.jsxs)("span",{className:"text-[10px] font-bold text-emerald-400 flex items-center gap-1",children:[(0,a.jsx)(ez.Z,{className:"w-3 h-3"})," ",null==d?void 0:d.totalCasesTrend]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-3xl font-bold tracking-tighter text-white",children:null==d?void 0:d.totalCases.toLocaleString()}),(0,a.jsx)("p",{className:"text-[11px] font-medium text-zinc-500 uppercase tracking-wider mt-1",children:"Total Cases"})]})]})}),(0,a.jsx)(eN,{className:"bg-[#161e31] border-zinc-800 shadow-xl",children:(0,a.jsxs)(ev,{className:"p-6 space-y-4",children:[(0,a.jsx)("div",{className:"p-2 bg-amber-500/10 rounded-lg w-fit",children:(0,a.jsx)(Z.Z,{className:"w-5 h-5 text-amber-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-3xl font-bold tracking-tighter text-white",children:null==d?void 0:d.openCases}),(0,a.jsx)("p",{className:"text-[11px] font-medium text-zinc-500 uppercase tracking-wider mt-1",children:"Open Cases"})]})]})}),(0,a.jsx)(eN,{className:"bg-[#161e31] border-zinc-800 shadow-xl",children:(0,a.jsxs)(ev,{className:"p-6 space-y-4",children:[(0,a.jsx)("div",{className:"p-2 bg-emerald-500/10 rounded-lg w-fit",children:(0,a.jsx)(ek.Z,{className:"w-5 h-5 text-emerald-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-3xl font-bold tracking-tighter text-white",children:null==d?void 0:d.closedCases.toLocaleString()}),(0,a.jsx)("p",{className:"text-[11px] font-medium text-zinc-500 uppercase tracking-wider mt-1",children:"Closed Cases"})]})]})}),(0,a.jsx)(eN,{className:"bg-[#161e31] border-zinc-800 shadow-xl",children:(0,a.jsxs)(ev,{className:"p-6 space-y-4",children:[(0,a.jsx)("div",{className:"p-2 bg-cyan-500/10 rounded-lg w-fit",children:(0,a.jsx)(eC.Z,{className:"w-5 h-5 text-cyan-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-3xl font-bold tracking-tighter text-white",children:null==d?void 0:d.mttd}),(0,a.jsx)("p",{className:"text-[11px] font-medium text-zinc-500 uppercase tracking-wider mt-1",children:"MTTD"}),(0,a.jsx)("p",{className:"text-[9px] text-zinc-600 mt-0.5 italic",children:"Mean Time to Detect"})]})]})}),(0,a.jsx)(eN,{className:"bg-[#161e31] border-zinc-800 shadow-xl",children:(0,a.jsxs)(ev,{className:"p-6 space-y-4",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-500/10 rounded-lg w-fit",children:(0,a.jsx)(ez.Z,{className:"w-5 h-5 text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-3xl font-bold tracking-tighter text-white",children:null==d?void 0:d.mttr}),(0,a.jsx)("p",{className:"text-[11px] font-medium text-zinc-500 uppercase tracking-wider mt-1",children:"MTTR"}),(0,a.jsx)("p",{className:"text-[9px] text-zinc-600 mt-0.5 italic",children:"Mean Time to Respond"})]})]})})]})}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-4",children:x?Array.from({length:2}).map((e,s)=>(0,a.jsx)(eN,{className:"bg-[#161e31] border-zinc-800 shadow-xl rounded-xl",children:(0,a.jsxs)(ev,{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"h-5 w-40 bg-zinc-800 rounded animate-pulse"}),(0,a.jsx)("div",{className:"h-3 w-32 bg-zinc-800 rounded animate-pulse"})]}),(0,a.jsx)("div",{className:"h-4 w-24 bg-zinc-800 rounded animate-pulse"})]}),(0,a.jsx)("div",{className:"h-64 w-full bg-zinc-800/50 rounded-lg animate-pulse"})]})},s)):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eN,{className:"bg-[#161e31] border-zinc-800 shadow-xl rounded-xl",children:(0,a.jsxs)(ev,{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-white",children:"Detection Time Trend"}),(0,a.jsx)("p",{className:"text-[11px] text-zinc-500",children:"Mean Time to Detect (MTTD)"})]}),(0,a.jsxs)("span",{className:"text-[11px] font-bold text-emerald-500 flex items-center gap-1",children:[(0,a.jsx)(ez.Z,{className:"w-3 h-3 rotate-180"})," ",m(c,"mttd")," vs last month"]})]}),(0,a.jsx)("div",{className:"h-64 w-full",children:(0,a.jsx)(eA.h,{width:"100%",height:"100%",children:(0,a.jsxs)(eS.T,{data:null!=c?c:[],children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"colorMttd",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:"#06b6d4",stopOpacity:.3}),(0,a.jsx)("stop",{offset:"95%",stopColor:"#06b6d4",stopOpacity:0})]})}),(0,a.jsx)(eT.q,{strokeDasharray:"3 3",vertical:!1,stroke:"#1e293b"}),(0,a.jsx)(eR.K,{dataKey:"time",hide:!0}),(0,a.jsx)(e_.B,{hide:!0}),(0,a.jsx)(eP.u,{contentStyle:{backgroundColor:"#0d1425",border:"1px solid #1e293b",borderRadius:"8px"},itemStyle:{color:"#06b6d4"}}),(0,a.jsx)(eE.u,{type:"monotone",dataKey:"mttd",stroke:"#06b6d4",strokeWidth:3,fillOpacity:1,fill:"url(#colorMttd)"})]})})})]})}),(0,a.jsx)(eN,{className:"bg-[#161e31] border-zinc-800 shadow-xl rounded-xl",children:(0,a.jsxs)(ev,{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-white",children:"Response Time Trend"}),(0,a.jsx)("p",{className:"text-[11px] text-zinc-500",children:"Mean Time to Respond (MTTR)"})]}),(0,a.jsxs)("span",{className:"text-[11px] font-bold text-emerald-500 flex items-center gap-1",children:[(0,a.jsx)(ez.Z,{className:"w-3 h-3 rotate-180"})," ",m(c,"mttr")," vs last month"]})]}),(0,a.jsx)("div",{className:"h-64 w-full",children:(0,a.jsx)(eA.h,{width:"100%",height:"100%",children:(0,a.jsxs)(eS.T,{data:null!=c?c:[],children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"colorMttr",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),(0,a.jsx)("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),(0,a.jsx)(eT.q,{strokeDasharray:"3 3",vertical:!1,stroke:"#1e293b"}),(0,a.jsx)(eR.K,{dataKey:"time",hide:!0}),(0,a.jsx)(e_.B,{hide:!0}),(0,a.jsx)(eP.u,{contentStyle:{backgroundColor:"#0d1425",border:"1px solid #1e293b",borderRadius:"8px"},itemStyle:{color:"#3b82f6"}}),(0,a.jsx)(eE.u,{type:"monotone",dataKey:"mttr",stroke:"#3b82f6",strokeWidth:3,fillOpacity:1,fill:"url(#colorMttr)"})]})})})]})})]})}),(0,a.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,a.jsx)(eN,{className:"bg-[#161e31] border-zinc-800 shadow-xl rounded-xl",children:(0,a.jsxs)(ev,{className:"p-6 space-y-6",children:[(0,a.jsx)("h3",{className:"font-bold text-white",children:"Detection Accuracy Metrics"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-4",children:h?Array.from({length:3}).map((e,s)=>(0,a.jsxs)("div",{className:"bg-[#111827] border border-zinc-800 rounded-xl p-5 space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{className:"h-4 w-24 bg-zinc-800 rounded animate-pulse"}),(0,a.jsx)("div",{className:"h-7 w-12 bg-zinc-800 rounded animate-pulse"})]}),(0,a.jsx)("div",{className:"h-2 w-full bg-zinc-800 rounded animate-pulse"}),(0,a.jsx)("div",{className:"h-3 w-32 bg-zinc-800 rounded animate-pulse"})]},s)):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-[#111827] border border-zinc-800 rounded-xl p-5 space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-zinc-300",children:"True Positive"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-emerald-500",children:null==u?void 0:u.truePositive.count})]}),(0,a.jsx)(eF,{value:parseFloat(null!==(t=null==u?void 0:u.truePositive.percentage)&&void 0!==t?t:"0")||0,className:"h-2 bg-zinc-800"}),(0,a.jsxs)("p",{className:"text-[10px] text-zinc-500 font-medium",children:[null==u?void 0:u.truePositive.percentage," of total detections"]})]}),(0,a.jsxs)("div",{className:"bg-[#111827] border border-zinc-800 rounded-xl p-5 space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-zinc-300",children:"False Positive"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-amber-500",children:null==u?void 0:u.falsePositive.count})]}),(0,a.jsx)(eF,{value:parseFloat(null!==(r=null==u?void 0:u.falsePositive.percentage)&&void 0!==r?r:"0")||0,className:"h-2 bg-zinc-800"}),(0,a.jsxs)("p",{className:"text-[10px] text-zinc-500 font-medium",children:[null==u?void 0:u.falsePositive.percentage," of total detections"]})]}),(0,a.jsxs)("div",{className:"bg-[#111827] border border-zinc-800 rounded-xl p-5 space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-zinc-300",children:"Benign Positive"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-500",children:null==u?void 0:u.benignPositive.count})]}),(0,a.jsx)(eF,{value:parseFloat(null!==(i=null==u?void 0:u.benignPositive.percentage)&&void 0!==i?i:"0")||0,className:"h-2 bg-zinc-800"}),(0,a.jsxs)("p",{className:"text-[10px] text-zinc-500 font-medium",children:[null==u?void 0:u.benignPositive.percentage," of total detections"]})]})]})})]})}),(0,a.jsx)(eN,{className:"bg-[#161e31] border-zinc-800 shadow-xl rounded-xl",children:(0,a.jsxs)(ev,{className:"p-6 space-y-4",children:[(0,a.jsx)("h3",{className:"font-bold text-white",children:"Recent Alert Activity"}),f?(0,a.jsx)("div",{className:"space-y-3",children:Array.from({length:4}).map((e,s)=>(0,a.jsx)("div",{className:"p-3 bg-[#111827] border border-zinc-800 rounded-lg animate-pulse",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-zinc-700 mt-1.5 shrink-0"}),(0,a.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,a.jsx)("div",{className:"h-3 w-full max-w-[200px] bg-zinc-800 rounded"}),(0,a.jsx)("div",{className:"h-3 w-16 bg-zinc-800 rounded"})]})]})},s))}):b?(0,a.jsx)("p",{className:"text-xs text-rose-500",children:"Unable to load recent activity."}):(0,a.jsxs)("div",{className:"space-y-3",children:[(null!=p?p:[]).map(e=>(0,a.jsx)("div",{className:"p-3 bg-[#111827] border border-zinc-800 rounded-lg hover:bg-[#161e31] transition-colors group cursor-default",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter(Boolean).join(" ")}("w-1.5 h-1.5 rounded-full mt-1.5 shrink-0","high"===e.type?"bg-rose-500 shadow-[0_0_8px_rgba(244,63,94,0.4)]":"completed"===e.type?"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.4)]":"medium"===e.type?"bg-amber-500 shadow-[0_0_8px_rgba(245,158,11,0.4)]":"bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.4)]")}),(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)("p",{className:"text-[12px] font-medium text-zinc-200 line-clamp-1",children:e.title}),(0,a.jsx)("p",{className:"text-[10px] text-zinc-500",children:e.time})]})]})},e.id)),Array.isArray(p)&&0===p.length&&(0,a.jsx)("p",{className:"text-xs text-zinc-500",children:"No recent activity found."})]})]})})]})]})}eH.displayName=eU.Z0.displayName;var e$=t(8029);let eQ=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:s,className:k("w-full caption-bottom text-sm",t),...r})})});eQ.displayName="Table";let eX=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("thead",{ref:s,className:k("[&_tr]:border-b",t),...r})});eX.displayName="TableHeader";let e0=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tbody",{ref:s,className:k("[&_tr:last-child]:border-0",t),...r})});e0.displayName="TableBody",c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tfoot",{ref:s,className:k("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r})}).displayName="TableFooter";let e1=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tr",{ref:s,className:k("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r})});e1.displayName="TableRow";let e2=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("th",{ref:s,className:k("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...r})});e2.displayName="TableHead";let e4=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("td",{ref:s,className:k("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...r})});e4.displayName="TableCell",c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("caption",{ref:s,className:k("mt-4 text-sm text-muted-foreground",t),...r})}).displayName="TableCaption";var e5=t(5872),e8=t(2171),e3=t(5432);let e6=e5.fC;e5.ZA;let e7=e5.B4,e9=c.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsxs)(e5.xz,{ref:s,className:k("flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...i,children:[r,(0,a.jsx)(e5.JO,{asChild:!0,children:(0,a.jsx)(e8.Z,{className:"h-4 w-4 opacity-50"})})]})});e9.displayName=e5.xz.displayName;let se=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e5.u_,{ref:s,className:k("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(e3.Z,{className:"h-4 w-4"})})});se.displayName=e5.u_.displayName;let ss=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e5.$G,{ref:s,className:k("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(e8.Z,{className:"h-4 w-4"})})});ss.displayName=e5.$G.displayName;let st=c.forwardRef((e,s)=>{let{className:t,children:r,position:i="popper",...n}=e;return(0,a.jsx)(e5.h_,{children:(0,a.jsxs)(e5.VY,{ref:s,className:k("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...n,children:[(0,a.jsx)(se,{}),(0,a.jsx)(e5.l_,{className:k("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(ss,{})]})})});st.displayName=e5.VY.displayName,c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e5.__,{ref:s,className:k("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=e5.__.displayName;let sa=c.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsxs)(e5.ck,{ref:s,className:k("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(e5.wU,{children:(0,a.jsx)(eL.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(e5.eT,{children:r})]})});sa.displayName=e5.ck.displayName,c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e5.Z0,{ref:s,className:k("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=e5.Z0.displayName;let sr=(0,v.j)("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate ",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:" border [border-color:var(--badge-outline)] shadow-xs"}},defaultVariants:{variant:"default"}});function si(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:k(sr({variant:t}),s),...r})}var sn=t(2779);function sl(){var e,s,t,r;let i=(0,o.NL)(),{toast:n}=j(),{logout:l,user:d}=ef(),[x,m]=(0,c.useState)(""),[u,h]=(0,c.useState)(1),[p]=(0,c.useState)(10),{data:f,isLoading:b,isError:g,isFetching:N}=(0,ej.a)({queryKey:["alerts",{page:u,pageSize:p}],queryFn:()=>ex({limit:p,skip:(u-1)*p}),placeholderData:e=>e}),v=null!==(e=null==f?void 0:f.items)&&void 0!==e?e:[],y=null!==(s=null==f?void 0:f.total)&&void 0!==s?s:v.length,w=Math.max(1,Math.ceil(y/p)),{data:z,isLoading:k,isError:C}=(0,ej.a)({queryKey:["alerts-assignable-users"],queryFn:ei}),A=(0,e$.D)({mutationFn:e=>{let{id:s,updates:t}=e;return em(s,t)},onSuccess:()=>{i.invalidateQueries({queryKey:["alerts"]}),n({title:"Update Successful",description:"Alert has been updated correctly."})}}),S=e=>{switch(e.toLowerCase()){case"critical":return"bg-rose-500/10 text-rose-500 border-rose-500/20";case"high":return"bg-orange-500/10 text-orange-500 border-orange-500/20";case"medium":return"bg-amber-500/10 text-amber-500 border-amber-500/20";default:return"bg-blue-500/10 text-blue-500 border-blue-500/20"}};return(0,a.jsxs)("div",{className:"p-8 space-y-8 bg-[#0a0f1e] min-h-screen text-zinc-100 font-sans",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{className:"relative w-96",children:[(0,a.jsx)(ey.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500"}),(0,a.jsx)(eI,{className:"bg-[#161e31] border-zinc-800 pl-10 h-10 rounded-lg text-sm focus:ring-cyan-500/20",placeholder:"Search alerts, IOCs, threat intel...",value:x,onChange:e=>m(e.target.value)})]}),(0,a.jsx)("div",{className:"flex items-center gap-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 pl-4 border-l border-zinc-800",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-white",children:null!==(t=null==d?void 0:d.name)&&void 0!==t?t:"Guest"}),(0,a.jsx)("p",{className:"text-[10px] text-zinc-500",children:null!==(r=null==d?void 0:d.email)&&void 0!==r?r:""})]}),(0,a.jsxs)(eK,{children:[(0,a.jsx)(eB,{asChild:!0,children:(0,a.jsx)(eM,{className:"h-10 w-10 border-2 border-cyan-500/20 cursor-pointer hover:border-cyan-500 transition-colors",children:(0,a.jsx)(eD,{className:"bg-cyan-600 text-white font-bold",children:((null==d?void 0:d.name)||"G").split(" ").map(e=>e[0]).slice(0,2).join("")})})}),(0,a.jsxs)(eY,{align:"end",className:"w-64 bg-[#161e31] border-zinc-800 text-zinc-100",children:[(0,a.jsx)(eW,{children:"My Profile"}),(0,a.jsx)(eH,{className:"bg-zinc-800"}),(0,a.jsxs)(eG,{className:"cursor-pointer hover:bg-zinc-800 focus:bg-zinc-800",children:[(0,a.jsx)(M.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Profile Details"})]}),(0,a.jsxs)(eG,{className:"cursor-pointer text-rose-500 focus:text-rose-500 hover:bg-rose-500/10 focus:bg-rose-500/10",onClick:()=>l(),children:[(0,a.jsx)(L.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Log out"})]})]})]})]})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-white",children:"Security Alerts"}),(0,a.jsx)("p",{className:"text-sm text-zinc-500",children:"Monitor and respond to security incidents"})]}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsxs)(Y,{variant:"outline",className:"bg-[#161e31] border-zinc-800 text-zinc-400 hover:text-white h-10",children:[(0,a.jsx)(sn.Z,{className:"w-4 h-4 mr-2"})," Export"]})})]}),(0,a.jsxs)("div",{className:"bg-[#111827] border border-zinc-800/50 rounded-xl overflow-hidden shadow-2xl",children:[(0,a.jsxs)(eQ,{children:[(0,a.jsx)(eX,{className:"bg-[#161e31]/50 border-b border-zinc-800",children:(0,a.jsxs)(e1,{className:"hover:bg-transparent border-zinc-800",children:[(0,a.jsx)(e2,{className:"text-cyan-400 font-bold text-xs uppercase tracking-wider py-4",children:"Alert Name"}),(0,a.jsx)(e2,{className:"text-cyan-400 font-bold text-xs uppercase tracking-wider",children:"Severity"}),(0,a.jsx)(e2,{className:"text-cyan-400 font-bold text-xs uppercase tracking-wider w-[300px]",children:"Description"}),(0,a.jsx)(e2,{className:"text-cyan-400 font-bold text-xs uppercase tracking-wider",children:"Status"}),(0,a.jsx)(e2,{className:"text-cyan-400 font-bold text-xs uppercase tracking-wider",children:"Assigned To"}),(0,a.jsx)(e2,{className:"text-cyan-400 font-bold text-xs uppercase tracking-wider",children:"Disposition"}),(0,a.jsx)(e2,{className:"text-cyan-400 font-bold text-xs uppercase tracking-wider text-right",children:"Actions"})]})}),(0,a.jsxs)(e0,{children:[b&&!f?Array.from({length:p}).map((e,s)=>(0,a.jsxs)(e1,{className:"border-zinc-800/50",children:[(0,a.jsx)(e4,{className:"py-5",children:(0,a.jsx)("div",{className:"h-4 w-32 bg-zinc-800 rounded animate-pulse"})}),(0,a.jsx)(e4,{children:(0,a.jsx)("div",{className:"h-5 w-16 bg-zinc-800 rounded animate-pulse"})}),(0,a.jsx)(e4,{children:(0,a.jsx)("div",{className:"h-4 w-48 bg-zinc-800 rounded animate-pulse"})}),(0,a.jsx)(e4,{children:(0,a.jsx)("div",{className:"h-8 w-24 bg-zinc-800 rounded animate-pulse"})}),(0,a.jsx)(e4,{children:(0,a.jsx)("div",{className:"h-8 w-28 bg-zinc-800 rounded animate-pulse"})}),(0,a.jsx)(e4,{children:(0,a.jsx)("div",{className:"h-8 w-24 bg-zinc-800 rounded animate-pulse"})}),(0,a.jsx)(e4,{className:"text-right",children:(0,a.jsx)("div",{className:"h-8 w-20 bg-zinc-800 rounded animate-pulse ml-auto"})})]},s)):!g&&(null==v?void 0:v.map(e=>{var s;return(0,a.jsxs)(e1,{className:"border-zinc-800/50 hover:bg-[#161e31]/30 transition-colors group",children:[(0,a.jsx)(e4,{className:"py-5 font-bold text-zinc-200",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-cyan-500 shadow-[0_0_8px_rgba(6,182,212,0.5)]"}),e.name]})}),(0,a.jsx)(e4,{children:(0,a.jsx)(si,{variant:"outline",className:function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter(Boolean).join(" ")}("px-3 py-0.5 rounded-full text-[10px] font-bold border",S(e.severity)),children:e.severity})}),(0,a.jsx)(e4,{className:"text-zinc-500 text-sm leading-relaxed truncate",children:e.description}),(0,a.jsx)(e4,{children:(0,a.jsxs)(e6,{defaultValue:e.status.toLowerCase().replace(" ","-"),onValueChange:s=>A.mutate({id:e.id,updates:{status:s}}),children:[(0,a.jsx)(e9,{className:"w-[120px] bg-[#161e31] border-zinc-800 text-zinc-300 h-8 text-xs",children:(0,a.jsx)(e7,{})}),(0,a.jsxs)(st,{className:"bg-[#161e31] border-zinc-800 text-zinc-300",children:[(0,a.jsx)(sa,{value:"open",children:"Open"}),(0,a.jsx)(sa,{value:"in-progress",children:"In Progress"}),(0,a.jsx)(sa,{value:"closed",children:"Closed"})]})]})}),(0,a.jsx)(e4,{children:(0,a.jsxs)(e6,{defaultValue:(null===(s=(z||[]).find(s=>s.name===e.assignedTo))||void 0===s?void 0:s.email)||"unassigned",onValueChange:s=>{if("unassigned"===s){A.mutate({id:e.id,updates:{assignedTo:"Unassigned",assignedToEmail:null}});return}let t=(z||[]).find(e=>e.email===s);t&&A.mutate({id:e.id,updates:{assignedTo:t.name,assignedToEmail:t.email}})},disabled:k||C,children:[(0,a.jsx)(e9,{className:"w-[160px] bg-[#161e31] border-zinc-800 text-zinc-300 h-8 text-xs",children:(0,a.jsx)(e7,{placeholder:k?"Loading users...":"Assign user"})}),(0,a.jsxs)(st,{className:"bg-[#161e31] border-zinc-800 text-zinc-300",children:[(0,a.jsx)(sa,{value:"unassigned",children:"Unassigned"}),(z||[]).map(e=>{var s;return(0,a.jsx)(sa,{value:e.email,children:e.name},null!==(s=e._id)&&void 0!==s?s:e.email)})]})]})}),(0,a.jsx)(e4,{children:(0,a.jsxs)(e6,{defaultValue:e.disposition.toLowerCase(),onValueChange:s=>A.mutate({id:e.id,updates:{disposition:s}}),children:[(0,a.jsx)(e9,{className:"w-[120px] bg-[#161e31] border-zinc-800 text-zinc-300 h-8 text-xs",children:(0,a.jsx)(e7,{})}),(0,a.jsxs)(st,{className:"bg-[#161e31] border-zinc-800 text-zinc-300",children:[(0,a.jsx)(sa,{value:"new",children:"New"}),(0,a.jsx)(sa,{value:"investigating",children:"Investigating"}),(0,a.jsx)(sa,{value:"escalated",children:"Escalated"}),(0,a.jsx)(sa,{value:"analyzing",children:"Analyzing"}),(0,a.jsx)(sa,{value:"closed",children:"Closed"})]})]})}),(0,a.jsx)(e4,{className:"text-right",children:(0,a.jsx)("div",{className:"flex items-center justify-end gap-2",children:(0,a.jsx)(Y,{className:"h-8 bg-cyan-600 text-white text-[11px] font-bold px-4 rounded-md opacity-40 cursor-not-allowed",disabled:!0,children:"Investigate"})})})]},e.id)})),(!v||0===v.length)&&!b&&(0,a.jsx)(e1,{children:(0,a.jsx)(e4,{colSpan:7,className:"py-6 text-center text-sm text-zinc-500",children:g?"Unable to load alerts.":"No alerts found."})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-3 border-t border-zinc-800 bg-[#0d1220] text-[12px] text-zinc-400",children:[(0,a.jsx)("div",{children:b&&!f?(0,a.jsx)("span",{children:"Loading alerts..."}):y>0?(0,a.jsxs)("span",{children:["Showing"," ",(0,a.jsxs)("span",{className:"text-zinc-200",children:[(u-1)*p+1,"-",Math.min(u*p,y)]})," ","of ",(0,a.jsx)("span",{className:"text-zinc-200",children:y})," alerts"]}):(0,a.jsx)("span",{children:"No alerts to display"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(Y,{variant:"outline",size:"sm",className:"h-7 px-3 bg-transparent border-zinc-700 text-zinc-300 disabled:opacity-40",onClick:()=>h(e=>Math.max(1,e-1)),disabled:1===u||N,children:"Previous"}),(0,a.jsxs)("span",{className:"text-[11px] text-zinc-400",children:["Page ",(0,a.jsx)("span",{className:"text-zinc-200",children:u})," of"," ",(0,a.jsx)("span",{className:"text-zinc-200",children:w})]}),(0,a.jsx)(Y,{variant:"outline",size:"sm",className:"h-7 px-3 bg-transparent border-zinc-700 text-zinc-300 disabled:opacity-40",onClick:()=>h(e=>Math.min(w,e+1)),disabled:u>=w||N,children:"Next"})]})]})]})]})}var sd=t(434);let so=sd.fC,sc=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sd.aV,{ref:s,className:k("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...r})});sc.displayName=sd.aV.displayName;let sx=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sd.xz,{ref:s,className:k("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...r})});sx.displayName=sd.xz.displayName;let sm=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sd.VY,{ref:s,className:k("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});sm.displayName=sd.VY.displayName;let su=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("textarea",{className:k("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...r})});su.displayName="Textarea";var sh=t(2217),sp=t(2761),sf=t(2553),sb=t(2278),sg=t(4442);let sj="192.168.1.100",sN=["[2026-02-23T14:21:02Z] auth-service WARN Failed login for user admin from 192.168.1.100","[2026-02-23T14:21:07Z] auth-service WARN Failed login for user admin from 192.168.1.100","[2026-02-23T14:21:13Z] auth-service WARN Failed login for user admin from 192.168.1.100","[2026-02-23T14:21:30Z] edge-firewall INFO Connection attempt flagged as suspicious (rule: brute_force_login)"];function sv(){let[e,s]=(0,r.yj)("/investigations/:id"),t=null==s?void 0:s.id,{data:i=[],isLoading:n,isError:l}=(0,ej.a)({queryKey:["investigation-timeline",t],queryFn:()=>eu(t),enabled:!!t});return t?(0,a.jsxs)("div",{className:"p-8 space-y-6 bg-[#0a0f1e] min-h-screen text-zinc-100 font-sans",children:[(0,a.jsx)(r.rU,{href:"/alerts",children:(0,a.jsxs)(Y,{variant:"ghost",className:"pl-0 text-zinc-400 hover:text-cyan-400 hover:bg-transparent",children:[(0,a.jsx)(sp.Z,{className:"mr-2 h-4 w-4"})," Back to Alerts"]})}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold tracking-tight text-white",children:["Investigation - ","Unusual Login Failure from Admin Account"]}),(0,a.jsxs)("p",{className:"text-xs text-zinc-500",children:["Case ID ","CASE-1243"," \xb7 Linked alert ",t," \xb7 Severity"," ",(0,a.jsx)("span",{className:"text-amber-400 font-semibold",children:"High"})]})]})}),(0,a.jsxs)(so,{defaultValue:"raw",className:"space-y-4",children:[(0,a.jsxs)(sc,{className:"bg-[#111827] border border-zinc-800 rounded-lg px-1 py-1",children:[(0,a.jsx)(sx,{value:"raw",className:"data-[state=active]:bg-[#0b1120] data-[state=active]:text-cyan-400",children:"Raw Logs"}),(0,a.jsx)(sx,{value:"ioc",className:"data-[state=active]:bg-[#0b1120] data-[state=active]:text-cyan-400",children:"IOC Extraction"}),(0,a.jsx)(sx,{value:"intel",className:"data-[state=active]:bg-[#0b1120] data-[state=active]:text-cyan-400",children:"Threat Intel"}),(0,a.jsx)(sx,{value:"summary",className:"data-[state=active]:bg-[#0b1120] data-[state=active]:text-cyan-400",children:"Summary"}),(0,a.jsx)(sx,{value:"notes",className:"data-[state=active]:bg-[#0b1120] data-[state=active]:text-cyan-400",children:"Notes"}),(0,a.jsx)(sx,{value:"verdict",className:"data-[state=active]:bg-[#0b1120] data-[state=active]:text-cyan-400",children:"Verdict"})]}),(0,a.jsx)(sm,{value:"raw",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,a.jsx)(eN,{className:"col-span-2 bg-[#111827] border-zinc-800",children:(0,a.jsx)(ev,{className:"p-6 space-y-3",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-4 w-48 bg-zinc-800 rounded animate-pulse mb-2"}),(0,a.jsx)("div",{className:"bg-[#020617] border border-zinc-800 rounded-lg p-3 space-y-2 max-h-72",children:Array.from({length:5}).map((e,s)=>(0,a.jsx)("div",{className:"h-3 bg-zinc-800 rounded animate-pulse w-full",style:{width:"".concat(80-10*s,"%")}},s))})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("h3",{className:"font-semibold text-sm text-zinc-200 mb-2 flex items-center gap-2",children:[(0,a.jsx)(sf.Z,{className:"w-4 h-4 text-cyan-400"}),"Raw Authentication Logs"]}),(0,a.jsx)("div",{className:"bg-[#020617] border border-zinc-800 rounded-lg p-3 text-xs font-mono text-zinc-300 space-y-1 max-h-72 overflow-auto",children:sN.map((e,s)=>(0,a.jsx)("div",{children:e},s))})]})})}),(0,a.jsx)(sy,{timeline:i,isLoading:n,isError:l})]})}),(0,a.jsx)(sm,{value:"ioc",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,a.jsx)(eN,{className:"col-span-2 bg-[#111827] border-zinc-800",children:(0,a.jsxs)(ev,{className:"p-6 space-y-6",children:[(0,a.jsxs)("h3",{className:"font-semibold text-sm text-zinc-200 mb-2 flex items-center gap-2",children:[(0,a.jsx)(sb.Z,{className:"w-4 h-4 text-emerald-400"}),"Extracted Indicators of Compromise"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-[#020617] border border-zinc-800 rounded-lg p-4 space-y-3",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-zinc-400 uppercase tracking-wider",children:"IP Addresses"}),(0,a.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-mono text-zinc-100",children:sj}),(0,a.jsx)("span",{className:"text-red-400 text-[10px] font-semibold",children:"Suspicious"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-mono text-zinc-100",children:"10.0.0.5"}),(0,a.jsx)("span",{className:"text-emerald-400 text-[10px] font-semibold",children:"Clean"})]})]})]}),(0,a.jsxs)("div",{className:"bg-[#020617] border border-zinc-800 rounded-lg p-4 space-y-3",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-zinc-400 uppercase tracking-wider",children:"User Agents"}),(0,a.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,a.jsx)("p",{className:"font-mono text-zinc-100",children:"Mozilla/5.0 (Unknown OS)"}),(0,a.jsx)("p",{className:"text-amber-400 text-[11px]",children:"Unusual user agent seen for this account"})]})]})]})]})}),(0,a.jsx)(sy,{timeline:i,isLoading:n,isError:l})]})}),(0,a.jsx)(sm,{value:"intel",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,a.jsx)(eN,{className:"col-span-2 bg-[#111827] border-zinc-800",children:(0,a.jsxs)(ev,{className:"p-6 space-y-4",children:[(0,a.jsxs)("h3",{className:"font-semibold text-sm text-zinc-200 mb-2 flex items-center gap-2",children:[(0,a.jsx)(Z.Z,{className:"w-4 h-4 text-amber-400"}),"Threat Intelligence Findings (Mock)"]}),(0,a.jsxs)("ul",{className:"list-disc list-inside text-xs text-zinc-300 space-y-2",children:[(0,a.jsxs)("li",{children:["Source IP ",sj," has 3 prior entries in threat feeds for"," ",(0,a.jsx)("span",{className:"text-amber-300",children:"credential stuffing activity"}),"."]}),(0,a.jsxs)("li",{children:["User agent pattern matches known ",(0,a.jsx)("span",{className:"text-amber-300",children:"automation toolkit"}),"."]}),(0,a.jsx)("li",{children:"No confirmed malware C2 domains observed in this session."})]})]})}),(0,a.jsx)(sy,{timeline:i,isLoading:n,isError:l})]})}),(0,a.jsx)(sm,{value:"summary",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,a.jsx)(eN,{className:"col-span-2 bg-[#111827] border-zinc-800",children:(0,a.jsxs)(ev,{className:"p-6 space-y-4",children:[(0,a.jsxs)("h3",{className:"font-semibold text-sm text-zinc-200 mb-3 flex items-center gap-2",children:[(0,a.jsx)(sf.Z,{className:"w-4 h-4 text-cyan-400"}),"AIGenerated Initial Summary (Mock)"]}),(0,a.jsxs)("div",{className:"space-y-3 text-xs text-zinc-300",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-zinc-200 mb-1",children:"Incident Overview"}),(0,a.jsxs)("p",{children:["Multiple failed login attempts detected from IP ",sj," targeting an administrative account. The pattern suggests automated credential stuffing using common username/password combinations."]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-zinc-200 mb-1",children:"Risk Assessment"}),(0,a.jsxs)("p",{children:["This activity represents a ",(0,a.jsx)("span",{className:"text-amber-300 font-semibold",children:"HIGH"})," severity threat. Successful compromise could lead to elevated access to critical systems."]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-zinc-200 mb-1",children:"Recommended Actions"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,a.jsxs)("li",{children:["Immediately block IP ",sj," at the firewall."]}),(0,a.jsx)("li",{children:"Force password reset for the targeted account."}),(0,a.jsx)("li",{children:"Ensure MFA is enforced for all privileged users."}),(0,a.jsx)("li",{children:"Monitor for additional suspicious logins from related IP ranges."})]})]})]})]})}),(0,a.jsx)(sy,{timeline:i,isLoading:n,isError:l})]})}),(0,a.jsx)(sm,{value:"notes",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,a.jsx)(eN,{className:"col-span-2 bg-[#111827] border-zinc-800",children:(0,a.jsxs)(ev,{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("h3",{className:"font-semibold text-sm text-zinc-200 flex items-center gap-2",children:[(0,a.jsx)(sg.Z,{className:"w-4 h-4 text-cyan-400"}),"Investigation Notes"]}),(0,a.jsx)(Y,{size:"sm",className:"h-8 bg-cyan-600 hover:bg-cyan-500 text-xs px-3",children:"Add Note"})]}),(0,a.jsxs)("div",{className:"bg-[#020617] border border-zinc-800 rounded-lg p-4 text-xs space-y-1",children:[(0,a.jsx)("p",{className:"font-semibold text-zinc-200",children:"Alice Chen \xb7 14:45 UTC"}),(0,a.jsx)("p",{className:"text-zinc-300",children:"Confirmed brute force attack pattern. IP has been added to blocklist. Coordinating with IAM team to enforce password reset and MFA."})]})]})}),(0,a.jsx)(sy,{timeline:i,isLoading:n,isError:l})]})}),(0,a.jsx)(sm,{value:"verdict",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,a.jsx)(eN,{className:"col-span-2 bg-[#111827] border-zinc-800",children:(0,a.jsxs)(ev,{className:"p-6 space-y-6",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm text-zinc-200 mb-2",children:"Final Determination (Mock)"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-xs",children:[(0,a.jsxs)("button",{className:"flex flex-col items-start gap-2 rounded-lg border border-emerald-500/40 bg-emerald-500/10 px-4 py-3 text-left hover:bg-emerald-500/20 transition",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-emerald-400",children:"True Positive"}),(0,a.jsx)("span",{className:"text-[11px] text-emerald-100",children:"Confirmed threat"})]}),(0,a.jsxs)("button",{className:"flex flex-col items-start gap-2 rounded-lg border border-amber-500/40 bg-amber-500/5 px-4 py-3 text-left hover:bg-amber-500/15 transition",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-amber-300",children:"False Positive"}),(0,a.jsx)("span",{className:"text-[11px] text-amber-100",children:"Benign activity"})]}),(0,a.jsxs)("button",{className:"flex flex-col items-start gap-2 rounded-lg border border-blue-500/40 bg-blue-500/5 px-4 py-3 text-left hover:bg-blue-500/15 transition",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-blue-300",children:"Escalate"}),(0,a.jsx)("span",{className:"text-[11px] text-blue-100",children:"Requires review"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-zinc-300",children:"Verdict Notes"}),(0,a.jsx)(su,{className:"min-h-[120px] bg-[#020617] border-zinc-800 text-xs text-zinc-100",placeholder:"Enter your determination and reasoning (mock textarea, not persisted)..."})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(Y,{variant:"outline",className:"border-zinc-700 text-zinc-300",children:"Cancel"}),(0,a.jsx)(Y,{className:"bg-cyan-600 hover:bg-cyan-500 text-white",children:"Submit Verdict (Mock)"})]})]})}),(0,a.jsx)(sy,{timeline:i,isLoading:n,isError:l})]})})]})]}):(0,a.jsx)("div",{className:"p-8 flex items-center justify-center h-full",children:(0,a.jsxs)("div",{className:"text-center space-y-4 max-w-md",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto",children:(0,a.jsx)(sh.Z,{className:"w-8 h-8 text-primary"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Investigation Center"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Select an alert from the Alerts console to start an investigation or view case details."}),(0,a.jsx)(r.rU,{href:"/alerts",children:(0,a.jsx)(Y,{className:"mt-4",children:"Go to Alerts Console"})})]})})}function sy(e){let{timeline:s,isLoading:t,isError:r}=e;return(0,a.jsx)(eN,{className:"bg-[#111827] border-zinc-800",children:(0,a.jsxs)(ev,{className:"p-6 space-y-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm text-zinc-200 mb-1",children:"Investigation Timeline"}),t&&(0,a.jsx)("p",{className:"text-xs text-zinc-500",children:"Loading timeline..."}),r&&!t&&(0,a.jsx)("p",{className:"text-xs text-rose-500",children:"Unable to load timeline."}),!t&&!r&&(0,a.jsx)("div",{className:"space-y-3 text-xs",children:0===s.length?(0,a.jsx)("p",{className:"text-zinc-500",children:"No timeline events yet."}):s.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"mt-1 h-2 w-2 rounded-full shrink-0 "+("done"===e.status?"bg-emerald-400 shadow-[0_0_8px_rgba(16,185,129,0.6)]":"bg-zinc-600")}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-zinc-100",children:e.label}),(0,a.jsx)("p",{className:"text-[11px] text-zinc-500",children:e.description})]})]}),(0,a.jsx)("span",{className:"text-[11px] text-zinc-500 shrink-0",children:e.time})]},s))})]})})}var sw=t(1604),sz=t(6312);let sk=G.fC,sC=G.xz,sA=G.h_;G.x8;let sS=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(G.aV,{ref:s,className:k("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});sS.displayName=G.aV.displayName;let sT=c.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsxs)(sA,{children:[(0,a.jsx)(sS,{}),(0,a.jsxs)(G.VY,{ref:s,className:k("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...i,children:[r,(0,a.jsxs)(G.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(y.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});sT.displayName=G.VY.displayName;let sR=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:k("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};sR.displayName="DialogHeader";let s_=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(G.Dx,{ref:s,className:k("text-lg font-semibold leading-none tracking-tight",t),...r})});s_.displayName=G.Dx.displayName;let sP=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(G.dk,{ref:s,className:k("text-sm text-muted-foreground",t),...r})});sP.displayName=G.dk.displayName;var sE=t(7536),sO=t(9102);let sF=(0,v.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),sI=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sO.f,{ref:s,className:k(sF(),t),...r})});sI.displayName=sO.f.displayName;let sZ=sE.RV,sM=c.createContext({}),sD=e=>{let{...s}=e;return(0,a.jsx)(sM.Provider,{value:{name:s.name},children:(0,a.jsx)(sE.Qr,{...s})})},sU=()=>{let e=c.useContext(sM),s=c.useContext(sV),{getFieldState:t,formState:a}=(0,sE.Gc)(),r=t(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=s;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...r}},sV=c.createContext({}),sL=c.forwardRef((e,s)=>{let{className:t,...r}=e,i=c.useId();return(0,a.jsx)(sV.Provider,{value:{id:i},children:(0,a.jsx)("div",{ref:s,className:k("space-y-2",t),...r})})});sL.displayName="FormItem";let sq=c.forwardRef((e,s)=>{let{className:t,...r}=e,{error:i,formItemId:n}=sU();return(0,a.jsx)(sI,{ref:s,className:k(i&&"text-destructive",t),htmlFor:n,...r})});sq.displayName="FormLabel";let sK=c.forwardRef((e,s)=>{let{...t}=e,{error:r,formItemId:i,formDescriptionId:n,formMessageId:l}=sU();return(0,a.jsx)(K.g7,{ref:s,id:i,"aria-describedby":r?"".concat(n," ").concat(l):"".concat(n),"aria-invalid":!!r,...t})});sK.displayName="FormControl",c.forwardRef((e,s)=>{let{className:t,...r}=e,{formDescriptionId:i}=sU();return(0,a.jsx)("p",{ref:s,id:i,className:k("text-sm text-muted-foreground",t),...r})}).displayName="FormDescription";let sB=c.forwardRef((e,s)=>{var t;let{className:r,children:i,...n}=e,{error:l,formMessageId:d}=sU(),o=l?String(null!==(t=null==l?void 0:l.message)&&void 0!==t?t:""):i;return o?(0,a.jsx)("p",{ref:s,id:d,className:k("text-sm font-medium text-destructive",r),...n,children:o}):null});sB.displayName="FormMessage";var sY=t(2220),sG=t(6691),sW=t(6147),sH=t(3416);function sJ(){let{toast:e}=j(),[s,t]=(0,c.useState)(!1),{data:r,isLoading:i}=(0,ej.a)({queryKey:["users"],queryFn:ea}),{data:n}=(0,ej.a)({queryKey:["roles"],queryFn:en}),l=sw.z.object({name:sw.z.string().min(1,"Name is required"),email:sw.z.string().email("Enter a valid email"),mobile:sw.z.string().regex(/^[0-9]{10}$/,"Enter a valid 10-digit mobile number"),password:sw.z.string().min(6,"Password must be at least 6 characters"),role:sw.z.enum(["user","admin"])}),o=(0,sE.cI)({resolver:(0,sz.F)(l),defaultValues:{name:"",email:"",mobile:"",password:"",role:"user"}}),x=(0,e$.D)({mutationFn:async e=>await er(e),onSuccess:()=>{d.invalidateQueries({queryKey:["users"]}),e({title:"Success",description:"User created successfully"}),t(!1),o.reset()},onError:s=>{e({title:"Error",description:s.message||"Failed to create user",variant:"destructive"})}});return i?(0,a.jsx)("div",{className:"p-8 text-zinc-500 animate-pulse",children:"Loading users..."}):(0,a.jsxs)("div",{className:"p-8 space-y-8 bg-[#0a0f1e] min-h-screen text-zinc-100",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-white",children:"User Management"}),(0,a.jsx)("p",{className:"text-sm text-zinc-500",children:"Manage SOC analysts and administrators"})]}),(0,a.jsxs)(sk,{open:s,onOpenChange:t,children:[(0,a.jsx)(sC,{asChild:!0,children:(0,a.jsxs)(Y,{className:"bg-cyan-600 hover:bg-cyan-500 text-white",children:[(0,a.jsx)(sY.Z,{className:"w-4 h-4 mr-2"}),"Add User"]})}),(0,a.jsxs)(sT,{className:"bg-[#161e31] border-zinc-800 text-zinc-100",children:[(0,a.jsxs)(sR,{children:[(0,a.jsx)(s_,{children:"Add New User"}),(0,a.jsx)("p",{className:"text-sm text-zinc-500",children:"Enter user details to create a new SOC account."})]}),(0,a.jsx)(sZ,{...o,children:(0,a.jsxs)("form",{onSubmit:o.handleSubmit(e=>x.mutate(e)),className:"space-y-4",children:[(0,a.jsx)(sD,{control:o.control,name:"name",render:e=>{let{field:s}=e;return(0,a.jsxs)(sL,{children:[(0,a.jsx)(sq,{children:"Full Name"}),(0,a.jsx)(sK,{children:(0,a.jsx)(eI,{...s,className:"bg-[#0a0f1e] border-zinc-800",placeholder:"John Doe"})}),(0,a.jsx)(sB,{})]})}}),(0,a.jsx)(sD,{control:o.control,name:"email",render:e=>{let{field:s}=e;return(0,a.jsxs)(sL,{children:[(0,a.jsx)(sq,{children:"Email Address"}),(0,a.jsx)(sK,{children:(0,a.jsx)(eI,{...s,type:"email",className:"bg-[#0a0f1e] border-zinc-800",placeholder:"john@aurisiem.com"})}),(0,a.jsx)(sB,{})]})}}),(0,a.jsx)(sD,{control:o.control,name:"mobile",render:e=>{let{field:s}=e;return(0,a.jsxs)(sL,{children:[(0,a.jsx)(sq,{children:"Mobile Number"}),(0,a.jsx)(sK,{children:(0,a.jsx)(eI,{...s,className:"bg-[#0a0f1e] border-zinc-800",placeholder:"+1234567890"})}),(0,a.jsx)(sB,{})]})}}),(0,a.jsx)(sD,{control:o.control,name:"password",render:e=>{let{field:s}=e;return(0,a.jsxs)(sL,{children:[(0,a.jsx)(sq,{children:"Password"}),(0,a.jsx)(sK,{children:(0,a.jsx)(eI,{...s,type:"password",className:"bg-[#0a0f1e] border-zinc-800"})}),(0,a.jsx)(sB,{})]})}}),(0,a.jsx)(sD,{control:o.control,name:"role",render:e=>{let{field:s}=e;return(0,a.jsxs)(sL,{children:[(0,a.jsx)(sq,{children:"Role"}),(0,a.jsxs)(e6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,a.jsx)(sK,{children:(0,a.jsx)(e9,{className:"bg-[#0a0f1e] border-zinc-800",children:(0,a.jsx)(e7,{placeholder:"Select a role"})})}),(0,a.jsx)(st,{className:"bg-[#161e31] border-zinc-800 text-zinc-100",children:null==n?void 0:n.map(e=>(0,a.jsx)(sa,{value:e.value,children:e.label},e.value))})]}),(0,a.jsx)(sB,{})]})}}),(0,a.jsx)(Y,{type:"submit",className:"w-full bg-cyan-600 hover:bg-cyan-500",disabled:x.isPending,children:x.isPending?"Creating...":"Create User"})]})})]})]})]}),(0,a.jsx)("div",{className:"bg-[#111827] border border-zinc-800/50 rounded-xl overflow-hidden",children:(0,a.jsxs)(eQ,{children:[(0,a.jsx)(eX,{className:"bg-[#161e31]/50",children:(0,a.jsxs)(e1,{className:"hover:bg-transparent border-zinc-800",children:[(0,a.jsx)(e2,{className:"text-cyan-400 font-bold text-xs uppercase py-4",children:"Name"}),(0,a.jsx)(e2,{className:"text-cyan-400 font-bold text-xs uppercase",children:"Email"}),(0,a.jsx)(e2,{className:"text-cyan-400 font-bold text-xs uppercase",children:"Mobile"}),(0,a.jsx)(e2,{className:"text-cyan-400 font-bold text-xs uppercase",children:"Role"})]})}),(0,a.jsx)(e0,{children:null==r?void 0:r.map(e=>{var s;let t=null!==(s=e._id)&&void 0!==s?s:e.id;return(0,a.jsxs)(e1,{className:"border-zinc-800/50 hover:bg-[#161e31]/30 transition-colors",children:[(0,a.jsx)(e4,{className:"py-4 font-medium text-zinc-200",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(M.Z,{className:"w-4 h-4 text-zinc-500"}),e.name]})}),(0,a.jsx)(e4,{className:"text-zinc-400",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sG.Z,{className:"w-3 h-3"}),e.email||"N/A"]})}),(0,a.jsx)(e4,{className:"text-zinc-400",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sW.Z,{className:"w-3 h-3"}),e.mobile||"N/A"]})}),(0,a.jsx)(e4,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sH.Z,{className:"w-3 h-3 text-cyan-500"}),(0,a.jsx)("span",{className:"capitalize",children:e.role})]})})]},t)})})]})})]})}var s$=t(6069);let sQ=c.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(s$.fC,{ref:s,className:k("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:(0,a.jsx)(s$.z$,{className:k("flex items-center justify-center text-current"),children:(0,a.jsx)(eL.Z,{className:"h-4 w-4"})})})});function sX(){let[e,s]=(0,c.useState)(""),[t,i]=(0,c.useState)(""),[n,l]=(0,c.useState)(!1),[d,x]=(0,c.useState)(!1),[m,u]=(0,c.useState)(""),[h,p]=(0,c.useState)(!1),[f,b]=(0,c.useState)("email"),[g,N]=(0,c.useState)(""),[v,y]=(0,c.useState)(""),[w,z]=(0,c.useState)(""),k=(0,o.NL)(),{login:C}=ef(),[,A]=(0,r.TH)(),{toast:S}=j(),T=async s=>{s.preventDefault(),l(!0),await C(e,t)?(await k.invalidateQueries(),S({title:"Access Granted",description:"Redirecting to AuriSIEM Dashboard..."}),A("/")):S({variant:"destructive",title:"Access Denied",description:"Invalid credentials. Please try again."}),l(!1)},R=()=>{b("email"),u(""),N(""),y(""),z(""),p(!1)},_=async e=>{if(e.preventDefault(),m){p(!0);try{await et.sendOtp(m),S({title:"OTP sent",description:"We have sent a 6-digit OTP to ".concat(m,".")}),b("otp")}catch(e){S({variant:"destructive",title:"Unable to send OTP",description:(null==e?void 0:e.message)||"Please try again later."})}finally{p(!1)}}},P=async e=>{if(e.preventDefault(),g){p(!0);try{await et.verifyOtp(m,g),S({title:"OTP verified",description:"Please enter your new password."}),b("password")}catch(e){S({variant:"destructive",title:"Invalid OTP",description:(null==e?void 0:e.message)||"Please check the code and try again."})}finally{p(!1)}}},E=async e=>{if(e.preventDefault(),!v||!w){S({variant:"destructive",title:"Missing information",description:"Please enter and confirm your new password."});return}if(v!==w){S({variant:"destructive",title:"Passwords do not match",description:"Make sure both password fields are identical."});return}p(!0);try{await et.updatePassword(m,v),S({title:"Password updated",description:"You can now sign in with your new password."}),s(m),i(v),x(!1),R()}catch(e){S({variant:"destructive",title:"Unable to update password",description:(null==e?void 0:e.message)||"Please try again later."})}finally{p(!1)}};return(0,a.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-[#0a0f1e] p-4 relative overflow-hidden font-sans",children:[(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-blue-600/10 rounded-full blur-[120px] pointer-events-none"}),(0,a.jsxs)("div",{className:"w-full max-w-[440px] z-10 space-y-8",children:[(0,a.jsx)(eN,{className:"border-zinc-800/50 bg-[#0d1425]/80 backdrop-blur-2xl shadow-2xl rounded-2xl p-4",children:(0,a.jsxs)(ev,{className:"pt-8 space-y-8",children:[(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"p-4 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-2xl shadow-[0_0_20px_rgba(6,182,212,0.5)]",children:(0,a.jsx)(sH.Z,{className:"w-10 h-10 text-white"})})}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-white",children:"AuriSIEM"}),(0,a.jsx)("p",{className:"text-[11px] font-bold tracking-[0.2em] text-cyan-400 uppercase",children:"Optimum Security"})]})]}),(0,a.jsxs)("form",{onSubmit:T,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(sI,{htmlFor:"username",className:"text-xs font-semibold text-zinc-400 ml-1",children:"Email Address"}),(0,a.jsx)(eI,{id:"username",type:"text",placeholder:"analyst@aurisiem.com",value:e,onChange:e=>s(e.target.value),className:"h-12 bg-[#161e31] border-zinc-800 text-zinc-100 placeholder:text-zinc-600 focus:ring-cyan-500/20 focus:border-cyan-500/50 rounded-xl transition-all",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"flex justify-between items-center ml-1",children:(0,a.jsx)(sI,{htmlFor:"password",className:"text-xs font-semibold text-zinc-400",children:"Password"})}),(0,a.jsx)(eI,{id:"password",type:"password",placeholder:"Enter your password",value:t,onChange:e=>i(e.target.value),className:"h-12 bg-[#161e31] border-zinc-800 text-zinc-100 placeholder:text-zinc-600 focus:ring-cyan-500/20 focus:border-cyan-500/50 rounded-xl transition-all",required:!0})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between px-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(sQ,{id:"remember",className:"border-zinc-700 data-[state=checked]:bg-cyan-500 data-[state=checked]:border-cyan-500"}),(0,a.jsx)("label",{htmlFor:"remember",className:"text-xs font-medium text-zinc-400 cursor-pointer",children:"Remember me"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>{u(e),b("email"),N(""),y(""),z(""),x(!0)},className:"text-xs font-medium text-cyan-500 hover:text-cyan-400 transition-colors",children:"Forgot Password?"})]}),(0,a.jsx)(Y,{type:"submit",className:"w-full h-12 bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-400 hover:to-blue-500 text-white font-bold rounded-xl shadow-[0_4px_15px_rgba(6,182,212,0.3)] transition-all active:scale-[0.98]",disabled:n,children:n?"Authenticating...":"Sign In"})]}),(0,a.jsx)(sk,{open:d,onOpenChange:e=>{x(e),e||R()},children:(0,a.jsxs)(sT,{className:"bg-[#161e31] border-zinc-800 text-zinc-100",children:[(0,a.jsxs)(sR,{children:[(0,a.jsx)(s_,{children:"Reset password"}),"email"===f&&(0,a.jsx)(sP,{children:"Enter your email address and we will send a 6-digit OTP to verify your identity."}),"otp"===f&&(0,a.jsx)(sP,{children:"Enter the 6-digit OTP we sent to your email."}),"password"===f&&(0,a.jsx)(sP,{children:"OTP verified. Set a new password for your account."})]}),"email"===f&&(0,a.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(sI,{htmlFor:"reset-email",className:"text-xs font-semibold text-zinc-400 ml-1",children:"Email Address"}),(0,a.jsx)(eI,{id:"reset-email",type:"email",placeholder:"analyst@aurisiem.com",value:m,onChange:e=>u(e.target.value),className:"h-11 bg-[#0a0f1e] border-zinc-800 text-zinc-100 placeholder:text-zinc-600 focus:ring-cyan-500/20 focus:border-cyan-500/50 rounded-xl transition-all",required:!0})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,a.jsx)(Y,{type:"button",variant:"outline",className:"border-zinc-700 text-zinc-300",onClick:()=>x(!1),disabled:h,children:"Cancel"}),(0,a.jsx)(Y,{type:"submit",className:"bg-cyan-600 hover:bg-cyan-500 text-white",disabled:h,children:h?"Sending...":"Send OTP"})]})]}),"otp"===f&&(0,a.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(sI,{htmlFor:"reset-otp",className:"text-xs font-semibold text-zinc-400 ml-1",children:"OTP"}),(0,a.jsx)(eI,{id:"reset-otp",type:"text",maxLength:6,placeholder:"Enter 6-digit OTP",value:g,onChange:e=>N(e.target.value),className:"h-11 bg-[#0a0f1e] border-zinc-800 text-zinc-100 placeholder:text-zinc-600 focus:ring-cyan-500/20 focus:border-cyan-500/50 rounded-xl transition-all tracking-[0.5em] text-center",required:!0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center pt-2",children:[(0,a.jsx)("button",{type:"button",className:"text-[11px] text-cyan-400 hover:text-cyan-300",onClick:()=>b("email"),disabled:h,children:"Change email"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(Y,{type:"button",variant:"outline",className:"border-zinc-700 text-zinc-300",onClick:()=>x(!1),disabled:h,children:"Cancel"}),(0,a.jsx)(Y,{type:"submit",className:"bg-cyan-600 hover:bg-cyan-500 text-white",disabled:h,children:h?"Verifying...":"Verify OTP"})]})]})]}),"password"===f&&(0,a.jsxs)("form",{onSubmit:E,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(sI,{htmlFor:"new-password",className:"text-xs font-semibold text-zinc-400 ml-1",children:"New Password"}),(0,a.jsx)(eI,{id:"new-password",type:"password",placeholder:"Enter new password",value:v,onChange:e=>y(e.target.value),className:"h-11 bg-[#0a0f1e] border-zinc-800 text-zinc-100 placeholder:text-zinc-600 focus:ring-cyan-500/20 focus:border-cyan-500/50 rounded-xl transition-all",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(sI,{htmlFor:"confirm-password",className:"text-xs font-semibold text-zinc-400 ml-1",children:"Confirm Password"}),(0,a.jsx)(eI,{id:"confirm-password",type:"password",placeholder:"Re-enter new password",value:w,onChange:e=>z(e.target.value),className:"h-11 bg-[#0a0f1e] border-zinc-800 text-zinc-100 placeholder:text-zinc-600 focus:ring-cyan-500/20 focus:border-cyan-500/50 rounded-xl transition-all",required:!0})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,a.jsx)(Y,{type:"button",variant:"outline",className:"border-zinc-700 text-zinc-300",onClick:()=>x(!1),disabled:h,children:"Cancel"}),(0,a.jsx)(Y,{type:"submit",className:"bg-cyan-600 hover:bg-cyan-500 text-white",disabled:h,children:h?"Updating...":"Update password"})]})]})]})})]})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("p",{className:"text-[10px] text-zinc-600 font-medium",children:"AuriSIEM v2.4.1 | Powered by Advanced AI Analytics"})})]})]})}sQ.displayName=s$.fC.displayName;var s0=t(8655);function s1(){return(0,a.jsx)("div",{className:"min-h-screen w-full flex items-center justify-center bg-background p-4",children:(0,a.jsx)(eN,{className:"w-full max-w-md glass-card border-border",children:(0,a.jsxs)(ev,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"flex mb-4 gap-2",children:[(0,a.jsx)(s0.Z,{className:"h-8 w-8 text-red-500"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"404 Page Not Found"})]}),(0,a.jsx)("p",{className:"mt-4 text-muted-foreground text-sm",children:"The resource you are looking for might have been removed, had its name changed, or is temporarily unavailable."}),(0,a.jsx)("div",{className:"mt-8 flex justify-end",children:(0,a.jsx)(r.rU,{href:"/",children:(0,a.jsx)(Y,{children:"Return to Dashboard"})})})]})})})}function s2(e){let{component:s,path:t}=e,{isAuthenticated:i}=ef();return(0,a.jsx)(r.AW,{path:t,children:()=>i?(0,a.jsx)(s,{}):(0,a.jsx)(r.l_,{to:"/login"})})}function s4(e){let{children:s}=e;return(0,a.jsxs)("div",{className:"flex min-h-screen bg-background text-foreground font-sans",children:[(0,a.jsx)(eg,{}),(0,a.jsx)("main",{className:"flex-1 overflow-auto bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-background to-background",children:s})]})}function s5(){let{isAuthenticated:e}=ef();return(0,a.jsxs)(r.rs,{children:[(0,a.jsx)(r.AW,{path:"/login",children:e?(0,a.jsx)(r.l_,{to:"/"}):(0,a.jsx)(sX,{})}),(0,a.jsx)(s2,{path:"/",component:()=>(0,a.jsx)(s4,{children:(0,a.jsx)(eJ,{})})}),(0,a.jsx)(s2,{path:"/alerts",component:()=>(0,a.jsx)(s4,{children:(0,a.jsx)(sl,{})})}),(0,a.jsx)(s2,{path:"/investigations",component:()=>(0,a.jsx)(s4,{children:(0,a.jsx)(sv,{})})}),(0,a.jsx)(s2,{path:"/investigations/:id",component:()=>(0,a.jsx)(s4,{children:(0,a.jsx)(sv,{})})}),(0,a.jsx)(s2,{path:"/users",component:()=>(0,a.jsx)(s4,{children:(0,a.jsx)(sJ,{})})}),(0,a.jsx)(s2,{path:"/reports",component:()=>(0,a.jsx)(s4,{children:(0,a.jsx)("div",{className:"p-8 text-muted-foreground",children:"Reports Module - Coming Soon"})})}),(0,a.jsx)(s2,{path:"/settings",component:()=>(0,a.jsx)(s4,{children:(0,a.jsx)("div",{className:"p-8 text-muted-foreground",children:"Settings Module - Coming Soon"})})}),(0,a.jsx)(r.AW,{path:"/:rest*",children:e?(0,a.jsx)(s1,{}):(0,a.jsx)(r.l_,{to:"/login"})})]})}var s8=function(){return(0,a.jsx)(o.aH,{client:d,children:(0,a.jsx)(ep,{children:(0,a.jsxs)(F,{children:[(0,a.jsx)(s5,{}),(0,a.jsx)(E,{})]})})})}}}]);